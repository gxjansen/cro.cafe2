---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout title="Color Accessibility Analysis">
  <div class="color-test-container">
    <h1>Color Accessibility Analysis</h1>
    
    <section class="intro">
      <p>Analyzing the accessibility of the current color palette and providing optimized recommendations for both light and dark modes.</p>
    </section>

    <!-- Current Colors Analysis -->
    <section class="current-colors">
      <h2>Current Colors Analysis</h2>
      <div class="color-grid">
        <div class="color-card">
          <div class="color-swatch" style="background-color: #95c3c0;"></div>
          <h3>Primary (Soft Teal)</h3>
          <code>#95c3c0</code>
          <div class="contrast-info">
            <p>On white: <span id="teal-white-contrast"></span></p>
            <p>On black: <span id="teal-black-contrast"></span></p>
          </div>
        </div>
        
        <div class="color-card">
          <div class="color-swatch" style="background-color: #dd8e91;"></div>
          <h3>Accent (Coral/Pink)</h3>
          <code>#dd8e91</code>
          <div class="contrast-info">
            <p>On white: <span id="coral-white-contrast"></span></p>
            <p>On black: <span id="coral-black-contrast"></span></p>
          </div>
        </div>
      </div>
    </section>

    <!-- WCAG Requirements -->
    <section class="wcag-requirements">
      <h2>WCAG AA Requirements</h2>
      <ul>
        <li><strong>Normal text:</strong> 4.5:1 contrast ratio</li>
        <li><strong>Large text (18pt+):</strong> 3:1 contrast ratio</li>
        <li><strong>UI components:</strong> 3:1 contrast ratio</li>
      </ul>
    </section>

    <!-- Recommended Colors -->
    <section class="recommended-colors">
      <h2>Recommended Optimized Colors</h2>
      
      <h3>Light Mode Palette</h3>
      <div class="color-grid">
        <div class="color-card">
          <div class="color-swatch" style="background-color: #5a8a87;"></div>
          <h4>Primary (Darker Teal)</h4>
          <code>#5a8a87</code>
          <p class="description">Maintains teal character with better contrast</p>
          <div class="contrast-info">
            <p>On white: <span id="new-teal-white-contrast"></span></p>
          </div>
        </div>
        
        <div class="color-card">
          <div class="color-swatch" style="background-color: #c05559;"></div>
          <h4>Accent (Deeper Coral)</h4>
          <code>#c05559</code>
          <p class="description">Preserves coral warmth with improved readability</p>
          <div class="contrast-info">
            <p>On white: <span id="new-coral-white-contrast"></span></p>
          </div>
        </div>
      </div>

      <h3>Dark Mode Palette</h3>
      <div class="color-grid">
        <div class="color-card">
          <div class="color-swatch" style="background-color: #a8d5d2;"></div>
          <h4>Primary (Light Teal)</h4>
          <code>#a8d5d2</code>
          <p class="description">Lighter teal for dark backgrounds</p>
          <div class="contrast-info">
            <p>On #1a1a1a: <span id="light-teal-dark-contrast"></span></p>
          </div>
        </div>
        
        <div class="color-card">
          <div class="color-swatch" style="background-color: #f0a5a8;"></div>
          <h4>Accent (Light Coral)</h4>
          <code>#f0a5a8</code>
          <p class="description">Softer coral for dark mode</p>
          <div class="contrast-info">
            <p>On #1a1a1a: <span id="light-coral-dark-contrast"></span></p>
          </div>
        </div>
      </div>
    </section>

    <!-- Visual Examples -->
    <section class="visual-examples">
      <h2>Visual Examples</h2>
      
      <div class="mode-examples">
        <div class="light-mode-example">
          <h3>Light Mode</h3>
          <div class="example-card light">
            <h4 style="color: #5a8a87;">Primary Heading</h4>
            <p>Regular text in default color</p>
            <button class="primary-button">Primary Button</button>
            <button class="accent-button">Accent Button</button>
            <a href="#" style="color: #5a8a87;">Primary Link</a>
            <a href="#" style="color: #c05559;">Accent Link</a>
          </div>
        </div>
        
        <div class="dark-mode-example">
          <h3>Dark Mode</h3>
          <div class="example-card dark">
            <h4 style="color: #a8d5d2;">Primary Heading</h4>
            <p>Regular text in default color</p>
            <button class="primary-button-dark">Primary Button</button>
            <button class="accent-button-dark">Accent Button</button>
            <a href="#" style="color: #a8d5d2;">Primary Link</a>
            <a href="#" style="color: #f0a5a8;">Accent Link</a>
          </div>
        </div>
      </div>
    </section>

    <!-- Implementation Guide -->
    <section class="implementation">
      <h2>Implementation Guide</h2>
      
      <h3>CSS Variables Setup</h3>
      <pre><code>:root {
  /* Light mode colors */
  --color-primary: #5a8a87;
  --color-primary-light: #95c3c0;
  --color-accent: #c05559;
  --color-accent-light: #dd8e91;
  
  /* Backgrounds */
  --color-bg: #ffffff;
  --color-bg-secondary: #f5f5f5;
  --color-text: #1a1a1a;
  --color-text-muted: #666666;
}

[data-theme="dark"] {
  /* Dark mode colors */
  --color-primary: #a8d5d2;
  --color-primary-light: #c5e5e3;
  --color-accent: #f0a5a8;
  --color-accent-light: #ffc0c3;
  
  /* Backgrounds */
  --color-bg: #1a1a1a;
  --color-bg-secondary: #2a2a2a;
  --color-text: #e5e5e5;
  --color-text-muted: #999999;
}</code></pre>

      <h3>Usage Examples</h3>
      <pre><code>/* Buttons */
.button-primary {
  background-color: var(--color-primary);
  color: white;
  border: 2px solid transparent;
}

.button-primary:hover {
  background-color: var(--color-primary-light);
}

/* Links */
a {
  color: var(--color-primary);
  text-decoration: underline;
}

a:hover {
  color: var(--color-accent);
}

/* Headings */
h1, h2, h3 {
  color: var(--color-text);
}

.accent-heading {
  color: var(--color-accent);
}</code></pre>
    </section>

    <!-- Summary -->
    <section class="summary">
      <h2>Summary & Recommendations</h2>
      <div class="recommendation-box">
        <h3>âœ… Recommended Color Palette</h3>
        <ul>
          <li><strong>Light Mode Primary:</strong> #5a8a87 (Darker Teal) - WCAG AA compliant</li>
          <li><strong>Light Mode Accent:</strong> #c05559 (Deeper Coral) - WCAG AA compliant</li>
          <li><strong>Dark Mode Primary:</strong> #a8d5d2 (Light Teal) - WCAG AA compliant</li>
          <li><strong>Dark Mode Accent:</strong> #f0a5a8 (Light Coral) - WCAG AA compliant</li>
        </ul>
        
        <h4>Key Benefits:</h4>
        <ul>
          <li>All colors meet WCAG AA standards for normal text</li>
          <li>Maintains the visual character of the original palette</li>
          <li>Provides excellent readability in both light and dark modes</li>
          <li>Works well for interactive elements and text</li>
        </ul>
      </div>
    </section>
  </div>

  <style>
    .color-test-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    section {
      margin-bottom: 3rem;
    }

    h1 {
      color: var(--color-text);
      margin-bottom: 2rem;
    }

    h2 {
      color: var(--color-text);
      margin-bottom: 1.5rem;
      border-bottom: 2px solid var(--color-border);
      padding-bottom: 0.5rem;
    }

    .color-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 2rem;
      margin-bottom: 2rem;
    }

    .color-card {
      background: var(--color-bg-secondary);
      border-radius: 8px;
      padding: 1.5rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .color-swatch {
      width: 100%;
      height: 100px;
      border-radius: 4px;
      margin-bottom: 1rem;
      border: 1px solid rgba(0, 0, 0, 0.1);
    }

    .color-card h3, .color-card h4 {
      margin: 0.5rem 0;
      color: var(--color-text);
    }

    .color-card code {
      display: block;
      background: var(--color-bg);
      padding: 0.5rem;
      border-radius: 4px;
      margin: 0.5rem 0;
      font-family: monospace;
      color: var(--color-text);
    }

    .contrast-info {
      margin-top: 1rem;
      font-size: 0.9rem;
    }

    .contrast-info p {
      margin: 0.25rem 0;
      color: var(--color-text-muted);
    }

    .contrast-info span {
      font-weight: bold;
      color: var(--color-text);
    }

    .description {
      font-size: 0.875rem;
      color: var(--color-text-muted);
      margin: 0.5rem 0;
    }

    .wcag-requirements {
      background: var(--color-bg-secondary);
      padding: 2rem;
      border-radius: 8px;
    }

    .wcag-requirements ul {
      list-style: none;
      padding: 0;
    }

    .wcag-requirements li {
      padding: 0.5rem 0;
      color: var(--color-text);
    }

    .mode-examples {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
    }

    .example-card {
      padding: 2rem;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .example-card.light {
      background: #ffffff;
      color: #1a1a1a;
    }

    .example-card.dark {
      background: #1a1a1a;
      color: #e5e5e5;
    }

    .primary-button, .accent-button,
    .primary-button-dark, .accent-button-dark {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 4px;
      margin: 0.5rem 0.5rem 0.5rem 0;
      cursor: pointer;
      font-weight: 500;
    }

    .primary-button {
      background: #5a8a87;
      color: white;
    }

    .accent-button {
      background: #c05559;
      color: white;
    }

    .primary-button-dark {
      background: #a8d5d2;
      color: #1a1a1a;
    }

    .accent-button-dark {
      background: #f0a5a8;
      color: #1a1a1a;
    }

    .example-card a {
      display: inline-block;
      margin: 0.5rem 0.5rem 0 0;
    }

    pre {
      background: var(--color-bg-secondary);
      padding: 1.5rem;
      border-radius: 8px;
      overflow-x: auto;
    }

    pre code {
      color: var(--color-text);
      font-size: 0.875rem;
      line-height: 1.5;
    }

    .recommendation-box {
      background: var(--color-bg-secondary);
      border-left: 4px solid #5a8a87;
      padding: 2rem;
      border-radius: 4px;
    }

    .recommendation-box h3 {
      color: #5a8a87;
      margin-top: 0;
    }

    .recommendation-box ul {
      margin: 1rem 0;
    }

    .recommendation-box li {
      margin: 0.5rem 0;
      color: var(--color-text);
    }

    .pass { color: #22c55e; }
    .fail { color: #ef4444; }
    .warning { color: #f59e0b; }

    @media (max-width: 768px) {
      .mode-examples {
        grid-template-columns: 1fr;
      }
      
      .color-test-container {
        padding: 1rem;
      }
    }
  </style>

  <script>
    // Function to calculate contrast ratio
    function getContrastRatio(color1, color2) {
      // Convert hex to RGB
      function hexToRgb(hex) {
        const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
        return result ? {
          r: parseInt(result[1], 16),
          g: parseInt(result[2], 16),
          b: parseInt(result[3], 16)
        } : null;
      }

      // Calculate relative luminance
      function getLuminance(rgb) {
        const rsRGB = rgb.r / 255;
        const gsRGB = rgb.g / 255;
        const bsRGB = rgb.b / 255;

        const r = rsRGB <= 0.03928 ? rsRGB / 12.92 : Math.pow((rsRGB + 0.055) / 1.055, 2.4);
        const g = gsRGB <= 0.03928 ? gsRGB / 12.92 : Math.pow((gsRGB + 0.055) / 1.055, 2.4);
        const b = bsRGB <= 0.03928 ? bsRGB / 12.92 : Math.pow((bsRGB + 0.055) / 1.055, 2.4);

        return 0.2126 * r + 0.7152 * g + 0.0722 * b;
      }

      const rgb1 = hexToRgb(color1);
      const rgb2 = hexToRgb(color2);

      const lum1 = getLuminance(rgb1);
      const lum2 = getLuminance(rgb2);

      const brightest = Math.max(lum1, lum2);
      const darkest = Math.min(lum1, lum2);

      return (brightest + 0.05) / (darkest + 0.05);
    }

    // Function to format contrast ratio with pass/fail indicator
    function formatContrast(ratio, threshold = 4.5) {
      const rounded = ratio.toFixed(2);
      const pass = ratio >= threshold;
      const className = pass ? 'pass' : 'fail';
      const icon = pass ? 'âœ“' : 'âœ—';
      return `<span class="${className}">${rounded}:1 ${icon}</span>`;
    }

    // Calculate and display contrast ratios
    document.addEventListener('DOMContentLoaded', function() {
      // Current colors
      document.getElementById('teal-white-contrast').innerHTML = formatContrast(getContrastRatio('#95c3c0', '#ffffff'));
      document.getElementById('teal-black-contrast').innerHTML = formatContrast(getContrastRatio('#95c3c0', '#000000'));
      document.getElementById('coral-white-contrast').innerHTML = formatContrast(getContrastRatio('#dd8e91', '#ffffff'));
      document.getElementById('coral-black-contrast').innerHTML = formatContrast(getContrastRatio('#dd8e91', '#000000'));

      // Recommended light mode colors
      document.getElementById('new-teal-white-contrast').innerHTML = formatContrast(getContrastRatio('#5a8a87', '#ffffff'));
      document.getElementById('new-coral-white-contrast').innerHTML = formatContrast(getContrastRatio('#c05559', '#ffffff'));

      // Recommended dark mode colors
      document.getElementById('light-teal-dark-contrast').innerHTML = formatContrast(getContrastRatio('#a8d5d2', '#1a1a1a'));
      document.getElementById('light-coral-dark-contrast').innerHTML = formatContrast(getContrastRatio('#f0a5a8', '#1a1a1a'));
    });
  </script>
</BaseLayout>